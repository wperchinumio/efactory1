---
description: Enforce Luno UI + AG Grid for the NEW app
globs:
  - "efactory-nextjs/app/**/*"
  - "efactory-nextjs/src/**/*"
  - "efactory-nextjs/components/**/*"
  - "efactory-nextjs/**/**.ts"
  - "efactory-nextjs/**/**.tsx"
alwaysApply: true
---

# Theme & Controls (MANDATORY)
- Use **Luno Next.js Tailwind Admin** components for ALL UI controls: inputs, selects, radios, checkboxes, buttons, tabs, dialogs, toasts, pagination, date/time pickers, etc.
- Use Luno layout, sidebar, top menu, and light/dark mode as-is.
- Do NOT introduce other UI kits or custom-styled controls.

# Tables
- **Complex tables → AG Grid**.
- **Simple tables → Luno table**.
- Complex grid heuristic (legacy): two API calls — (1) column structure (title/type/position), (2) data.
  - In AG Grid, fetch column defs and data separately and apply server-provided layout dynamically.

# Architecture & Tooling
- Next.js + TypeScript + TailwindCSS.
- Strict TS, ESLint + Prettier.
- Base API URL: `https://efactory.dclcorp.com`.
- Infer request/response shapes from the legacy code and create **TypeScript interfaces**.
- Implement **real authentication**; protect routes; no mock data.
- Recreate all legacy pages/workflows with live APIs.

# Package Manager
- Use **pnpm** for all installs, scripts, and lockfiles.
- Do not use npm or yarn. Replace any instructions with `pnpm add`, `pnpm install`, etc.

# Code Quality & Reuse
- Give priority to creating **reusable components**.  
- Shared UI elements (tables, forms, modals, buttons, etc.) should be abstracted into `components/` so that fixing/updating a component benefits the **entire site**.  
- Avoid duplicating UI logic across pages; favor composition and reuse.
